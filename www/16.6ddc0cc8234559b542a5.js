(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{OmbT:function(t,i,e){"use strict";function o(t){return t&&/^([A-Z\u00C0-\u024F\u1E00-\u1EFF]?)+([[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+[,.]?[ ]?|[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+['-]]?)+$/.test(t)}function n(t){const i=String.fromCharCode(t.charCode);/[0-9.,]/.test(i)||t.preventDefault()}function r(t){const{value:i}=t.target;/^([A-Z\u00C0-\u024F\u1E00-\u1EFF]?)+([[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+[,.]?[ ]?|[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+['-]]?)+$/.test(i)||(t.target.value=i.substring(0,i.length-1))}function s(t){return t&&/^[0-9]{1,3}/.test(""+t)}function a(t){return t&&/^([CC|CE|PE|TI|PAS]){2,3}[0-9]{5,20}$/.test(t)}function u(t){return t&&/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/.test(t)}function l(t){return t&&/^[\+]?[(]?([0-9]{2})?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(t)}function c(t){return t&&/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t)}function b(t){return t&&/^[a-zA-Z\xc1\xc9\xcd\xd3\xda\xc0\xc8\xcc\xd2\xd9\xe0\xe8\xec\xf2\xf9\xe1\xe9\xed\xf3\xfa\xc2\xca\xce\xd4\xdb\xe2\xea\xee\xf4\xfb\xc4\xcb\xcf\xd6\xdc\xe4\xeb\xef\xf6\xfc\xf1\xd10-9\s.,#*?\xbf\xa1!()\-+"'/@]{5,2000}/g.test(t)}function d(t){return t&&/\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])*/.test(""+t)}function g(t){return t&&/^([0-1]?[0-9]|2[0-4]):([0-5][0-9])(:[0-5][0-9])?$/.test(t)}function m(t,i=!1){return!!t&&(i?t.substr(0,40).indexOf("data:application/pdf")>-1:t.substr(0,21).indexOf("data:image/")>-1)}function h(t,i=!1){return t?i?t.replace(/\n/g,"<br/>"):t.replace(/<br ?\/?>/g,"\n"):null}function p(t){return t?t.replace(/&NBSP;/g," "):null}e.d(i,"g",function(){return o}),e.d(i,"l",function(){return n}),e.d(i,"k",function(){return r}),e.d(i,"f",function(){return s}),e.d(i,"c",function(){return a}),e.d(i,"j",function(){return u}),e.d(i,"h",function(){return l}),e.d(i,"d",function(){return c}),e.d(i,"i",function(){return b}),e.d(i,"b",function(){return d}),e.d(i,"e",function(){return g}),e.d(i,"a",function(){return m}),e.d(i,"n",function(){return h}),e.d(i,"m",function(){return p})},c341:function(t,i,e){"use strict";e.d(i,"a",function(){return a});var o=e("mrSG"),n=e("fXoL"),r=e("1Ldg"),s=e("4WDQ");let a=(()=>{class t{constructor(t,i){this.axios=t,this.globalSer=i}getGroupsTotals(t={}){return Object(o.a)(this,void 0,void 0,function*(){const i=yield this.axios.getData("/admin/groups/counters",t);return i&&i.success?i.data.totals:this.globalSer.altResponse(i)})}getGroups(t={}){return Object(o.a)(this,void 0,void 0,function*(){const i=yield this.axios.getData("/admin/groups",t);return i&&i.success?i.data.groups:this.globalSer.altResponse(i)})}getGroupDetails(t){return Object(o.a)(this,void 0,void 0,function*(){const i=yield this.axios.getData("/admin/groups/"+t);return i&&i.success?i.data.group:this.globalSer.altResponse(i)})}addGroup(t){return Object(o.a)(this,void 0,void 0,function*(){const i=yield this.axios.postData("/admin/groups",t);return i&&i.success?i.data.group:this.globalSer.altResponse(i)})}updateGroup(t,i={}){return Object(o.a)(this,void 0,void 0,function*(){const e=yield this.axios.putData("/admin/groups/"+t,i);return e&&e.success?e.data.group:this.globalSer.altResponse(e)})}deleteGroup(t){return Object(o.a)(this,void 0,void 0,function*(){const i=yield this.axios.deleteData("/admin/groups/"+t);return i&&i.success?i.data.msg:this.globalSer.altResponse(i)})}updateMembersListGroup(t,i,e){return Object(o.a)(this,void 0,void 0,function*(){const o=yield this.axios.putData(`/admin/groups/${t}/members/${i}`,e);return o&&o.success?o.data.msg:this.globalSer.altResponse(o)})}findMembersToGroup(t,i){return Object(o.a)(this,void 0,void 0,function*(){const e=yield this.axios.getData(`/admin/groups/${t}/find-members`,i);return e&&e.success?e.data.users:this.globalSer.altResponse(e)})}}return t.\u0275fac=function(i){return new(i||t)(n.Qb(r.a),n.Qb(s.a))},t.\u0275prov=n.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},c9Jc:function(t,i,e){"use strict";e.r(i),e.d(i,"FamiliasPageModule",function(){return O});var o=e("ofXK"),n=e("3Pt+"),r=e("TEn/"),s=e("tyNb"),a=e("mrSG"),u=e("OmbT"),l=e("fXoL"),c=e("1Ldg"),b=e("QTu/"),d=e("4WDQ"),g=e("c341");function m(t,i){if(1&t&&(l.Mb(0,"ion-card",1),l.Mb(1,"ion-card-content",2),l.Mb(2,"ion-row"),l.Mb(3,"ion-col",3),l.Kb(4,"ion-img",4),l.Lb(),l.Mb(5,"ion-col",5),l.Mb(6,"ion-text",6),l.Mb(7,"h3"),l.mc(8),l.Lb(),l.Lb(),l.Mb(9,"ion-text"),l.Mb(10,"b"),l.mc(11,"COD:"),l.Lb(),l.mc(12),l.Lb(),l.Kb(13,"br"),l.Mb(14,"ion-text"),l.Mb(15,"b"),l.mc(16,"Total de miembros:"),l.Lb(),l.mc(17),l.Lb(),l.Kb(18,"br"),l.Mb(19,"ion-text",7),l.Mb(20,"i",8),l.mc(21,"Clic para m\xe1s informaci\xf3n."),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb()),2&t){const t=l.Wb();l.xb(4),l.Zb("src","/assets/icon/personas_boton.svg"),l.xb(4),l.nc(t.group.name),l.xb(4),l.oc(" ",t.group.code,""),l.xb(5),l.oc(" ",t.group.totalMembers,"")}}let h=(()=>{class t{constructor(){this.group={_id:null,name:null,code:null,totalMembers:0}}ngOnInit(){this.data&&(this.group._id=this.data._id,this.group.name=this.data.name,this.group.code=this.data.code,this.group.totalMembers=this.data.totalMembers||0)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=l.Db({type:t,selectors:[["app-familiacard"]],inputs:{data:"data"},decls:1,vars:1,consts:[["class","ion-no-padding ion-no-margin ion-margin-start ion-margin-end ion-margin-bottom",4,"ngIf"],[1,"ion-no-padding","ion-no-margin","ion-margin-start","ion-margin-end","ion-margin-bottom"],[1,"ion-no-margin","ion-no-padding"],["size","3"],[1,"pictureIcon",3,"src"],["size","9"],["color","primary",1,"ion-margin-top","ion-margin-bottom"],[1,"ion-margin-top"],[1,"toSmall"]],template:function(t,i){1&t&&l.kc(0,m,22,4,"ion-card",0),2&t&&l.Zb("ngIf",i.group)},directives:[o.i,r.g,r.h,r.D,r.n,r.t,r.H],styles:[""]}),t})();var p=e("bM8H");function f(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-button",19),l.Ub("click",function(){return l.gc(t),l.Wb().setShowForm()}),l.Kb(1,"ion-icon",20),l.Mb(2,"ion-text"),l.mc(3),l.Lb(),l.Lb()}if(2&t){const t=l.Wb();l.xb(1),l.bc("name","",t.showForm?"close":"add","-outline"),l.xb(2),l.nc(t.showForm?"Cancelar":"Agregar grupo")}}function y(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-col",21),l.Mb(1,"ion-card"),l.Mb(2,"ion-card-content"),l.Mb(3,"ion-row"),l.Mb(4,"ion-col",4),l.Mb(5,"ion-item"),l.Mb(6,"ion-label",7),l.mc(7,"Nombre del grupo (*)"),l.Lb(),l.Mb(8,"ion-input",8),l.Ub("ngModelChange",function(i){return l.gc(t),l.Wb().formData.name=i}),l.Lb(),l.Lb(),l.Lb(),l.Mb(9,"ion-col",22),l.Mb(10,"ion-text",23),l.Mb(11,"i",24),l.mc(12,"(*) Campos requeridos."),l.Lb(),l.Lb(),l.Lb(),l.Mb(13,"ion-col",25),l.Mb(14,"ion-button",12),l.Ub("click",function(){return l.gc(t),l.Wb().setShowForm()}),l.Kb(15,"ion-icon",26),l.Mb(16,"ion-text"),l.mc(17,"Cancelar"),l.Lb(),l.Lb(),l.Mb(18,"ion-button",19),l.Ub("click",function(){return l.gc(t),l.Wb().confirmAction({})}),l.Kb(19,"ion-icon",27),l.Mb(20,"ion-text"),l.mc(21,"Guardar"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb()}if(2&t){const t=l.Wb();l.xb(8),l.Zb("ngModel",t.formData.name)}}function v(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-button",28),l.Ub("click",function(){l.gc(t);const i=l.Wb();return i.queryParams.word=null,i.findData()}),l.Kb(1,"ion-icon",29),l.Lb()}}function L(t,i){1&t&&l.Kb(0,"ion-icon",30)}function M(t,i){1&t&&l.Kb(0,"ion-icon",31)}function S(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-col",33),l.Ub("click",function(){l.gc(t);const e=i.$implicit;return l.Wb(2).showGroup(e._id)}),l.Kb(1,"app-familiacard",34),l.Lb()}if(2&t){const t=i.$implicit;l.xb(1),l.Zb("data",t)}}function w(t,i){if(1&t&&(l.Mb(0,"ion-row"),l.kc(1,S,2,1,"ion-col",32),l.Lb()),2&t){const t=l.Wb();l.xb(1),l.Zb("ngForOf",t.groups)}}function x(t,i){if(1&t&&(l.Mb(0,"div",35),l.Kb(1,"app-paginator",36),l.Lb()),2&t){const t=l.Wb();l.xb(1),l.Zb("totalPages",t.pages)("currentPage",t.queryParams.page)("handlePage",t.handlePage)}}function P(t,i){1&t&&(l.Mb(0,"ion-card",37),l.Mb(1,"ion-text"),l.Mb(2,"p",38),l.mc(3,"No existen grupos familiares registrados."),l.Lb(),l.Lb(),l.Lb())}const F=[{path:"",component:(()=>{class t{constructor(t,i,e,o,n,r){this.alertCtrl=t,this.axios=i,this.cookieService=e,this.globalSer=o,this.router=n,this.familiasService=r,this.showFilter=!1,this.showForm=!1,this.groups=[],this.totals=0,this.pages=0,this.page=1,this.queryParams={input:"name",value:-1,page:1,limit:10,word:null},this.formData={name:null,code:null},this.handlePage=t=>{this.queryParams.page=t,this.getGroupList()},this.globalSer.checkSession()||this.router.navigate(["/ingresar"])}ngOnInit(){return Object(a.a)(this,void 0,void 0,function*(){})}ionViewWillEnter(){return Object(a.a)(this,void 0,void 0,function*(){this.globalSer.checkSession()?yield this.getTotals():this.router.navigate(["/ingresar"])})}getTotals(){return Object(a.a)(this,void 0,void 0,function*(){this.totals=0,this.pages=0;const t=yield this.familiasService.getGroupsTotals(this.queryParams);t&&t>=0&&!t.error?(this.totals=t,this.pages=this.globalSer.getPagination(t,this.queryParams.limit),t>0?yield this.getGroupList():(this.queryParams.page=1,this.pages=0,this.groups=[])):t&&t.error?(this.queryParams.page=1,this.pages=0,this.groups=[],yield this.globalSer.presentAlert("Alerta","Disculpe, pero no se encontr\xf3 una sesi\xf3n activa."),this.router.navigate(["/ingresar"])):(this.queryParams.page=1,this.pages=0,this.groups=[])})}getGroupList(){return Object(a.a)(this,void 0,void 0,function*(){this.showFilter&&(this.showFilter=!1),yield this.globalSer.presentLoading();const t=yield this.familiasService.getGroups(this.queryParams);t&&!t.error?(this.groups=t,yield this.globalSer.dismissLoading()):t&&t.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}addGroup(){return Object(a.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading();const t=this.formData,i=yield this.familiasService.addGroup(t);i&&!i.error?(this.groups.push(i),this.setShowForm(),yield this.globalSer.dismissLoading(),yield this.globalSer.presentAlert("\xa1\xc9xito!","Se ha registrado el grupo exitosamente.")):i&&i.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}deleteGroup(t){return Object(a.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading();const i=yield this.familiasService.deleteGroup(t);i&&!i.error?(this.groups=this.groups.filter(i=>i._id!==t),yield this.globalSer.dismissLoading(),yield this.globalSer.presentAlert("\xa1\xc9xito!","Se ha eliminado los datos del grupo exitosamente.")):i&&i.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}setShowForm(){this.showForm?(this.formData.name=null,this.formData.code=null,this.showForm=!1):this.showForm=!0}setSortOrder(){return Object(a.a)(this,void 0,void 0,function*(){this.queryParams.value=1===this.queryParams.value?-1:1,this.queryParams.page=1,this.groups=null,yield this.getGroupList()})}findData(){return Object(a.a)(this,void 0,void 0,function*(){this.queryParams.page=1,this.pages=0,this.groups=null,yield this.getTotals()})}setQueryValues(){return Object(a.a)(this,void 0,void 0,function*(){this.globalSer.alertWithList({header:"Resultados por p\xe1gina",inputs:[{name:"results-per-page",type:"radio",label:"10",value:10,checked:10===this.queryParams.limit},{name:"results-per-page",type:"radio",label:"25",value:25,checked:25===this.queryParams.limit},{name:"results-per-page",type:"radio",label:"50",value:50,checked:50===this.queryParams.limit}],confirmAction:t=>{this.queryParams.limit=t,this.queryParams.page=1,this.pages=this.globalSer.getPagination(this.totals,this.queryParams.limit),this.groups=null,this.getGroupList()}})})}validateForm(){return Object(u.i)(this.formData.name)?null:"Disculpe, pero debe indicar un nombre correcto para el grupo."}showGroup(t){return Object(a.a)(this,void 0,void 0,function*(){const i=this.groups.find(i=>i._id===t);if(i){const e=yield this.alertCtrl.create({header:i.name,message:`<b>C\xf3digo:</b> ${i.code}<br/>\n          <b>Total de miembros:</b> ${i.totalMembers||0}<br/>\n        `,buttons:[{text:"Eliminar",role:"delete",handler:()=>{this.confirmAction({id:i._id,remove:!0})}},{text:"Ver detalles",handler:()=>{this.router.navigate(["/familias/"+t])}}]});yield e.present()}})}confirmAction({id:t,remove:i}){return Object(a.a)(this,void 0,void 0,function*(){let e=!0;if(this.showForm){const t=this.validateForm();t?(e=!1,yield this.globalSer.presentAlert("\xa1Error!",t||"Disculpe, pero debe completar el formulario.")):e=!0}if(e){let e="\xbfEst\xe1 seguro qu\xe9 desea __action__ este grupo?";e=e.replace("__action__",i?"eliminar a":"registrar a"),this.globalSer.alertConfirm({header:"Confirme",message:e,confirmAction:()=>{i?this.deleteGroup(t):this.addGroup()}})}})}}return t.\u0275fac=function(i){return new(i||t)(l.Jb(r.a),l.Jb(c.a),l.Jb(b.a),l.Jb(d.a),l.Jb(s.g),l.Jb(g.a))},t.\u0275cmp=l.Db({type:t,selectors:[["app-familias"]],decls:37,vars:13,consts:[["slot","end"],["color","primary",3,"click",4,"ngIf"],[1,"ion-margin-bottom"],["class","ion-no-margin","size","12",4,"ngIf"],["size","12"],["size-sm","7",3,"size"],["color","light","slot","start",3,"click",4,"ngIf"],["position","floating","color","medium"],["autocomplete","off",1,"ion-text-uppercase",3,"ngModel","ngModelChange"],["color","light","slot","end",3,"click"],["name","search-outline"],["size-sm","5",3,"size"],["color","light",3,"click"],["name","arrow-up-outline",4,"ngIf"],["name","arrow-down-outline",4,"ngIf"],["name","filter-outline"],[4,"ngIf","ngIfElse"],["class","ion-margin-top",4,"ngIf"],["noGroups",""],["color","primary",3,"click"],["slot","start",3,"name"],["size","12",1,"ion-no-margin"],["size","12","size-sm","12",1,"ion-margin-top"],["color","medium"],[1,"toSmall"],["size","12","size-sm","12",1,"ion-margin-top","ion-margin-bottom","ion-text-center"],["name","close-outline","slot","start"],["name","save-outline","slot","start"],["color","light","slot","start",3,"click"],["name","backspace-outline"],["name","arrow-up-outline"],["name","arrow-down-outline"],["size","12","size-sm","6",3,"click",4,"ngFor","ngForOf"],["size","12","size-sm","6",3,"click"],[3,"data"],[1,"ion-margin-top"],[3,"totalPages","currentPage","handlePage"],[1,"ion-no-padding"],[1,"ion-text-center"]],template:function(t,i){if(1&t&&(l.Mb(0,"ion-header"),l.Mb(1,"ion-toolbar"),l.Mb(2,"ion-title"),l.mc(3,"Grupos familiares"),l.Lb(),l.Mb(4,"ion-buttons",0),l.kc(5,f,4,2,"ion-button",1),l.Lb(),l.Lb(),l.Lb(),l.Mb(6,"ion-content"),l.Mb(7,"ion-row",2),l.kc(8,y,22,1,"ion-col",3),l.Mb(9,"ion-col",4),l.Mb(10,"ion-row"),l.Mb(11,"ion-col",5),l.Mb(12,"ion-toolbar"),l.kc(13,v,2,0,"ion-button",6),l.Mb(14,"ion-item"),l.Mb(15,"ion-label",7),l.mc(16,"Buscar por nombre o c\xf3digo"),l.Lb(),l.Mb(17,"ion-input",8),l.Ub("ngModelChange",function(t){return i.queryParams.word=t}),l.Lb(),l.Lb(),l.Mb(18,"ion-button",9),l.Ub("click",function(){return i.findData()}),l.Kb(19,"ion-icon",10),l.Lb(),l.Lb(),l.Lb(),l.Mb(20,"ion-col",11),l.Mb(21,"ion-toolbar"),l.Mb(22,"ion-button",12),l.Ub("click",function(){return i.setSortOrder()}),l.kc(23,L,1,0,"ion-icon",13),l.kc(24,M,1,0,"ion-icon",14),l.mc(25,"\xa0 "),l.Mb(26,"ion-text"),l.mc(27),l.Lb(),l.Lb(),l.Mb(28,"ion-button",12),l.Ub("click",function(){return i.setQueryValues()}),l.Kb(29,"ion-icon",15),l.mc(30,"\xa0 "),l.Mb(31,"ion-text"),l.mc(32),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.kc(33,w,2,1,"ion-row",16),l.kc(34,x,2,3,"div",17),l.kc(35,P,4,0,"ng-template",null,18,l.lc),l.Lb()),2&t){const t=l.fc(36);l.xb(5),l.Zb("ngIf",!i.showForm),l.xb(3),l.Zb("ngIf",i.showForm&&i.formData),l.xb(3),l.Zb("size",12),l.xb(2),l.Zb("ngIf",i.queryParams.word),l.xb(4),l.Zb("ngModel",i.queryParams.word),l.xb(3),l.Zb("size",12),l.xb(3),l.Zb("ngIf",1===i.queryParams.value),l.xb(1),l.Zb("ngIf",-1===i.queryParams.value),l.xb(3),l.nc(1===i.queryParams.value?"ASC":"DES"),l.xb(5),l.nc(i.queryParams.limit),l.xb(1),l.Zb("ngIf",i.groups&&i.groups.length>0)("ngIfElse",t),l.xb(1),l.Zb("ngIf",i.groups&&i.groups.length>0&&i.pages>0)}},directives:[r.r,r.K,r.J,r.f,o.i,r.o,r.D,r.n,r.v,r.w,r.u,r.T,n.e,n.f,r.e,r.s,r.H,r.g,r.h,o.h,h,p.a],styles:[""]}),t})()},{path:":id",loadChildren:()=>e.e(25).then(e.bind(null,"Rvzy")).then(t=>t.FamiliasDetallesPageModule)}];let k=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(i){return new(i||t)},imports:[[s.j.forChild(F)],s.j]}),t})();var D=e("j1ZV");let O=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(i){return new(i||t)},imports:[[o.b,n.a,r.L,k,D.a]]}),t})()}}]);