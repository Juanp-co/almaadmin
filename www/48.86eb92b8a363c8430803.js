(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{r9SS:function(e,i,t){"use strict";t.r(i),t.d(i,"DetallesGrupoPageModule",function(){return G});var n=t("ofXK"),o=t("3Pt+"),b=t("TEn/"),a=t("tyNb"),s=t("mrSG"),r=t("G9AF"),l=t("lmIc"),d=t("fXoL"),c=t("4WDQ"),m=t("ai4U"),u=t("hy3H"),h=t("2+X9"),g=t("ATsP");function p(e,i){if(1&e&&d.Kb(0,"app-user-group-card",5),2&e){const e=d.Wb();d.Zb("user",e.data)("handleRemove",e.handleRemove)("added",!0)}}function f(e,i){if(1&e){const e=d.Nb();d.Mb(0,"ion-card"),d.Mb(1,"ion-card-content"),d.Mb(2,"ion-text"),d.Mb(3,"p",6),d.Kb(4,"ion-icon",7),d.pc(5," No se ha asignado ning\xfan miembro a este rol. "),d.Kb(6,"br"),d.Mb(7,"ion-button",8),d.Ub("click",function(){d.ic(e);const i=d.Wb();return i.handleAdd(i.role||"leader")}),d.Kb(8,"ion-icon",9),d.Mb(9,"ion-text"),d.pc(10,"Asignar"),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb()}}let v=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=d.Db({type:e,selectors:[["app-members-card"]],inputs:{data:"data",title:"title",role:"role",handleDelete:"handleDelete",handleAdd:"handleAdd",handleRemove:"handleRemove"},decls:7,vars:3,consts:[[1,"w-100"],[1,"title-members-section"],[1,"separate-members-section"],[3,"user","handleRemove","added",4,"ngIf","ngIfElse"],["noExist",""],[3,"user","handleRemove","added"],[1,"ion-text-center"],["name","alert-circle-outline"],["color","primary",1,"ion-margin-top",3,"click"],["name","add-outline","slot","start"]],template:function(e,i){if(1&e&&(d.Mb(0,"div",0),d.Mb(1,"h2",1),d.pc(2),d.Lb(),d.Mb(3,"div",2),d.nc(4,p,1,3,"app-user-group-card",3),d.Lb(),d.nc(5,f,11,0,"ng-template",null,4,d.oc),d.Lb()),2&e){const e=d.hc(6);d.xb(2),d.qc(i.title||""),d.xb(2),d.Zb("ngIf",i.data)("ngIfElse",e)}},directives:[n.i,g.a,b.g,b.h,b.K,b.s,b.e],styles:[""]}),e})();function M(e,i){if(1&e){const e=d.Nb();d.Mb(0,"ion-button",1),d.Ub("click",function(){return d.ic(e),d.Wb(3).setShowView("data")}),d.Kb(1,"ion-icon",6),d.Lb()}if(2&e){const e=d.Wb(3);d.xb(1),d.bc("name","chevron-",e.views.data.show?"up":"down","-outline")}}function L(e,i){if(1&e){const e=d.Nb();d.Mb(0,"ion-button",1),d.Ub("click",function(){return d.ic(e),d.Wb(3).editEnable()}),d.Kb(1,"ion-icon",15),d.Lb()}}function w(e,i){if(1&e&&(d.Mb(0,"ion-title"),d.pc(1),d.Lb()),2&e){const e=d.Wb(3);d.xb(1),d.qc(e.views.data.label)}}function x(e,i){1&e&&(d.Mb(0,"ion-title"),d.pc(1,"Editar grupo familiar"),d.Lb())}function S(e,i){if(1&e){const e=d.Nb();d.Mb(0,"ion-button",18),d.Ub("click",function(){return d.ic(e),d.Wb(4).editEnable()}),d.Kb(1,"ion-icon",19),d.Mb(2,"ion-text"),d.pc(3,"Cancelar edici\xf3n"),d.Lb(),d.Lb()}}function y(e,i){if(1&e){const e=d.Nb();d.Mb(0,"ion-button",20),d.Ub("click",function(){return d.ic(e),d.Wb(4).editEnable()}),d.Kb(1,"ion-icon",21),d.Mb(2,"ion-text"),d.pc(3,"Editar"),d.Lb(),d.Lb()}}function I(e,i){if(1&e&&(d.Mb(0,"ion-buttons",9),d.nc(1,S,4,0,"ion-button",16),d.nc(2,y,4,0,"ion-button",17),d.Lb()),2&e){const e=d.Wb(3);d.xb(1),d.Zb("ngIf",e.views.data.edit),d.xb(1),d.Zb("ngIf",!e.views.data.edit)}}function A(e,i){if(1&e&&(d.Mb(0,"ion-col",22),d.Kb(1,"app-family-group-form",23),d.Lb()),2&e){const e=d.Wb(3);d.xb(1),d.Zb("data",e.formData)("handleSave",e.handleSave)("handleCancel",e.handleCancel)}}function z(e,i){if(1&e&&(d.Mb(0,"ion-col",24),d.Mb(1,"ion-row"),d.Mb(2,"ion-col",25),d.Mb(3,"ion-row"),d.Mb(4,"ion-col",26),d.Mb(5,"ion-text"),d.Mb(6,"b"),d.pc(7,"N\xfamero"),d.Lb(),d.Lb(),d.Lb(),d.Mb(8,"ion-col",27),d.Mb(9,"ion-text"),d.pc(10),d.Lb(),d.Lb(),d.Mb(11,"ion-col",26),d.Mb(12,"ion-text"),d.Mb(13,"b"),d.pc(14,"Sector:"),d.Lb(),d.Lb(),d.Lb(),d.Mb(15,"ion-col",27),d.Mb(16,"ion-text"),d.pc(17),d.Lb(),d.Lb(),d.Mb(18,"ion-col",26),d.Mb(19,"ion-text"),d.Mb(20,"b"),d.pc(21,"Sub-sector:"),d.Lb(),d.Lb(),d.Lb(),d.Mb(22,"ion-col",27),d.Mb(23,"ion-text"),d.pc(24),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Mb(25,"ion-col",25),d.Mb(26,"ion-row"),d.Mb(27,"ion-col",26),d.Mb(28,"ion-text"),d.Mb(29,"b"),d.pc(30,"Direcci\xf3n"),d.Lb(),d.Lb(),d.Lb(),d.Mb(31,"ion-col",27),d.Mb(32,"ion-text"),d.pc(33),d.Lb(),d.Lb(),d.Mb(34,"ion-col",26),d.Mb(35,"ion-text"),d.Mb(36,"b"),d.pc(37,"Fecha de creaci\xf3n:"),d.Lb(),d.Lb(),d.Lb(),d.Mb(38,"ion-col",27),d.Mb(39,"ion-text"),d.pc(40),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb()),2&e){const e=d.Wb(3);d.xb(10),d.qc(e.group.number),d.xb(7),d.qc(e.group.sector||"No indicado."),d.xb(7),d.qc(e.group.subSector||"No indicado."),d.xb(9),d.qc(e.group.direction||"No indicado."),d.xb(7),d.qc(e.group.created_at||"No indicado")}}function K(e,i){if(1&e&&(d.Mb(0,"ion-col",24),d.Mb(1,"div",28),d.Kb(2,"app-map",29),d.Lb(),d.Lb()),2&e){const e=d.Wb(3);d.xb(2),d.Zb("coords",e.getParamsToMap())("height","100%")("zoom",13)}}function Z(e,i){if(1&e&&(d.Mb(0,"ion-card"),d.Mb(1,"ion-card-header",4),d.Mb(2,"ion-toolbar",5),d.Mb(3,"ion-buttons",0),d.nc(4,M,2,1,"ion-button",10),d.nc(5,L,2,0,"ion-button",10),d.Lb(),d.nc(6,w,2,1,"ion-title",3),d.nc(7,x,2,0,"ion-title",3),d.nc(8,I,3,2,"ion-buttons",12),d.Lb(),d.Lb(),d.Mb(9,"ion-card-content"),d.Mb(10,"ion-row"),d.nc(11,A,2,3,"ion-col",13),d.nc(12,z,41,5,"ion-col",14),d.nc(13,K,3,3,"ion-col",14),d.Lb(),d.Lb(),d.Lb()),2&e){const e=d.Wb(2);d.xb(4),d.Zb("ngIf",!e.views.data.edit),d.xb(1),d.Zb("ngIf",e.views.data.edit),d.xb(1),d.Zb("ngIf",!e.views.data.edit),d.xb(1),d.Zb("ngIf",e.views.data.edit),d.xb(1),d.Zb("ngIf",e.views.data.show),d.xb(1),d.zb(e.views.data.show?"":"ion-hide"),d.xb(2),d.Zb("ngIf",e.views.data.edit),d.xb(1),d.Zb("ngIf",!e.views.data.edit),d.xb(1),d.Zb("ngIf",!e.views.data.edit)}}function k(e,i){if(1&e&&(d.Mb(0,"ion-row",30),d.Mb(1,"ion-col",31),d.Kb(2,"app-members-card",32),d.Lb(),d.Mb(3,"ion-col",31),d.Kb(4,"app-members-card",33),d.Lb(),d.Mb(5,"ion-col",31),d.Kb(6,"app-members-card",34),d.Lb(),d.Mb(7,"ion-col",31),d.Kb(8,"app-members-card",35),d.Lb(),d.Lb()),2&e){const e=d.Wb(2);d.xb(2),d.Zb("data",e.members.leader)("handleAdd",e.handleAddMember)("handleRemove",e.handleRemove),d.xb(2),d.Zb("data",e.members.host)("handleAdd",e.handleAddMember)("handleRemove",e.handleRemove),d.xb(2),d.Zb("data",e.members.helper)("handleAdd",e.handleAddMember)("handleRemove",e.handleRemove),d.xb(2),d.Zb("data",e.members.master)("handleAdd",e.handleAddMember)("handleRemove",e.handleRemove)}}function R(e,i){1&e&&(d.Mb(0,"ion-row",36),d.Mb(1,"ion-col",37),d.Mb(2,"ion-text",38),d.Mb(3,"p",39),d.Kb(4,"ion-icon",40),d.pc(5," No se logr\xf3 obtener los miembros de este grupo. "),d.Lb(),d.Lb(),d.Lb(),d.Lb())}function W(e,i){if(1&e){const e=d.Nb();d.Mb(0,"ion-button",1),d.Ub("click",function(){return d.ic(e),d.Wb(2).modalMember("assistants")}),d.Kb(1,"ion-icon",41),d.Mb(2,"ion-text"),d.pc(3,"Agregar"),d.Lb(),d.Lb()}}function j(e,i){if(1&e&&(d.Mb(0,"ion-col",46),d.Kb(1,"app-user-group-card",47),d.Lb()),2&e){const e=i.$implicit,t=d.Wb(4);d.xb(1),d.Zb("user",e)("handleRemove",t.handleRemove)("added",!0)}}function E(e,i){if(1&e&&(d.Mb(0,"ion-row"),d.nc(1,j,2,3,"ion-col",45),d.Lb()),2&e){const e=d.Wb(3);d.xb(1),d.Zb("ngForOf",e.members.assistants)}}function D(e,i){if(1&e){const e=d.Nb();d.Mb(0,"ion-card"),d.Mb(1,"ion-card-content"),d.Mb(2,"ion-text"),d.Mb(3,"p",39),d.Kb(4,"ion-icon",40),d.pc(5," No se han agregado asistentes. "),d.Kb(6,"br"),d.Mb(7,"ion-button",48),d.Ub("click",function(){return d.ic(e),d.Wb(3).modalMember("assistants")}),d.Kb(8,"ion-icon",49),d.Mb(9,"ion-text"),d.pc(10,"Asignar"),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb()}}function O(e,i){if(1&e&&(d.Mb(0,"ion-row",30),d.Mb(1,"ion-col",42),d.nc(2,E,2,1,"ion-row",43),d.nc(3,D,11,0,"ng-template",null,44,d.oc),d.Lb(),d.Lb()),2&e){const e=d.hc(4),i=d.Wb(2);d.xb(2),d.Zb("ngIf",(null==i.members.assistants?null:i.members.assistants.length)>0)("ngIfElse",e)}}function N(e,i){1&e&&(d.Mb(0,"ion-row",36),d.Mb(1,"ion-col",37),d.Mb(2,"ion-text",38),d.Mb(3,"p",39),d.Kb(4,"ion-icon",40),d.pc(5," No se logr\xf3 obtener los miembros de este grupo. "),d.Lb(),d.Lb(),d.Lb(),d.Lb())}function q(e,i){if(1&e){const e=d.Nb();d.Mb(0,"div"),d.nc(1,Z,14,11,"ion-card",3),d.Mb(2,"ion-card"),d.Mb(3,"ion-card-header",4),d.Mb(4,"ion-toolbar",5),d.Mb(5,"ion-buttons",0),d.Mb(6,"ion-button",1),d.Ub("click",function(){return d.ic(e),d.Wb().setShowView("members1")}),d.Kb(7,"ion-icon",6),d.Lb(),d.Lb(),d.Mb(8,"ion-title"),d.pc(9),d.Lb(),d.Lb(),d.Lb(),d.Mb(10,"ion-card-content"),d.nc(11,k,9,12,"ion-row",7),d.nc(12,R,6,0,"ng-template",null,8,d.oc),d.Lb(),d.Lb(),d.Mb(14,"ion-card"),d.Mb(15,"ion-card-header",4),d.Mb(16,"ion-toolbar",5),d.Mb(17,"ion-buttons",0),d.Mb(18,"ion-button",1),d.Ub("click",function(){return d.ic(e),d.Wb().setShowView("members2")}),d.Kb(19,"ion-icon",6),d.Lb(),d.Lb(),d.Mb(20,"ion-title"),d.pc(21),d.Lb(),d.Mb(22,"ion-buttons",9),d.nc(23,W,4,0,"ion-button",10),d.Lb(),d.Lb(),d.Lb(),d.Mb(24,"ion-card-content"),d.nc(25,O,5,2,"ion-row",7),d.nc(26,N,6,0,"ng-template",null,8,d.oc),d.Lb(),d.Lb(),d.Mb(28,"div",11),d.Kb(29,"br"),d.Lb(),d.Lb()}if(2&e){const e=d.hc(13),i=d.Wb();d.xb(1),d.Zb("ngIf",i.views.data.data),d.xb(1),d.zb(i.views.data.edit?"ion-hide":""),d.xb(5),d.bc("name","chevron-",i.views.members1.show?"up":"down","-outline"),d.xb(2),d.qc(i.views.members1.label),d.xb(1),d.zb(i.views.members1.show?"":"ion-hide"),d.xb(1),d.Zb("ngIf",i.members)("ngIfElse",e),d.xb(3),d.zb(i.views.data.edit?"ion-hide":""),d.xb(5),d.bc("name","chevron-",i.views.members2.show?"up":"down","-outline"),d.xb(2),d.qc(i.views.members2.label),d.xb(2),d.Zb("ngIf",(null==i.members||null==i.members.assistants?null:i.members.assistants.length)>0),d.xb(1),d.zb(i.views.members2.show?"":"ion-hide"),d.xb(1),d.Zb("ngIf",i.members)("ngIfElse",e)}}const U=[{path:"",component:(()=>{class e{constructor(e,i,t,n){this.activateRoute=e,this.globalSer=i,this.gruposService=t,this.navCtrl=n,this.title="Cargando...",this.id=null,this.group=null,this.formData=null,this.views={data:{label:"Datos del grupo",show:!0,edit:!1,data:null},members1:{label:"Miembros principales",show:!0},members2:{label:"Asistentes",show:!0}},this.members=null,this.handleAddMember=e=>this.modalMember(e),this.handleRemove=e=>this.removeMember(e),this.handleSave=e=>this.setFormDataAndSave(e),this.handleCancel=()=>Object(s.a)(this,void 0,void 0,function*(){return this.editEnable()})}ngOnInit(){return Object(s.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading(),this.id=this.activateRoute.snapshot.paramMap.get("id");const e=yield this.gruposService.getGroupDetails(this.id);e&&!e.error?(this.group=Object.assign({},e),this.views.data.data=e,this.members=e.members,this.title=this.getTitle(),yield this.globalSer.dismissLoading()):e&&e.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}updateData(){return Object(s.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading("Actualizando, por favor espere ...");const e=yield this.gruposService.updateGroup(this.id,this.formData);e&&!e.error?(this.group=Object.assign({},e),this.views.data.data=Object.assign({},e),this.title=this.getTitle(),yield this.editEnable(!0),yield this.globalSer.dismissLoading(),yield this.globalSer.presentAlert("\xa1\xc9xito!","Se ha actualizado la informaci\xf3n exitosamente.")):e&&e.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}updateMembers(e={}){var i,t,n,o,b;return Object(s.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading("Actualizando, por favor espere ...");const a={leaderId:(null===(i=e.leader)||void 0===i?void 0:i._id)||null,helperId:(null===(t=e.helper)||void 0===t?void 0:t._id)||null,hostId:(null===(n=e.host)||void 0===n?void 0:n._id)||null,assistantsIds:(null===(o=e.assistants)||void 0===o?void 0:o.map(e=>e._id))||[],masterId:(null===(b=e.master)||void 0===b?void 0:b._id)||null},s=yield this.gruposService.updateMembersGroup(this.id,{members:a});s&&!s.error?(this.group.members=Object.assign({},s),this.members=Object.assign({},s),yield this.globalSer.dismissLoading(),yield this.globalSer.presentAlert("\xa1\xc9xito!","Se ha actualizado la informaci\xf3n exitosamente.")):s&&s.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}getTitle(e=!1){return`${e?"Editando":"Detalles"}: Sector #${this.group.sector}, Sub-sector #${this.group.subSector}, Grupo #${this.group.number}`}back(){return Object(s.a)(this,void 0,void 0,function*(){yield this.navCtrl.back()})}setShowView(e){return Object(s.a)(this,void 0,void 0,function*(){this.views[e].show=!this.views[e].show,this.views[e].edit&&(yield this.editEnable())})}editEnable(e=!1){return Object(s.a)(this,void 0,void 0,function*(){e||(yield this.globalSer.presentLoading()),this.views.data.edit=!this.views.data.edit,this.views.data.edit?(this.formData={sector:this.views.data.data.sector,subSector:this.views.data.data.subSector,number:this.views.data.data.number,direction:this.views.data.data.direction,location:this.views.data.data.location||{type:"Point",coordinates:l.c}},this.title=this.getTitle(!0)):(this.title=this.getTitle(),this.formData=null),e||(yield this.globalSer.dismissLoading())})}modalMember(e){return Object(s.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading(),yield this.globalSer.dismissLoading(),yield this.globalSer.loadModal(r.a,{data:Object.assign({},this.members)},!1,i=>{if(i){const t=Object.assign({},this.members);"assistants"===e?t[e].push(i):t[e]=i,this.updateMembers(t)}})})}removeMember(e){const i=()=>{var i,t,n,o,b;const a=this.members?Object.assign({},this.members):null;a&&((null===(i=a.host)||void 0===i?void 0:i._id)===e&&(a.host=null),(null===(t=a.helper)||void 0===t?void 0:t._id)===e&&(a.helper=null),(null===(n=a.leader)||void 0===n?void 0:n._id)===e&&(a.leader=null),(null===(o=a.master)||void 0===o?void 0:o._id)===e&&(a.master=null),a.assistants=(null===(b=a.assistants)||void 0===b?void 0:b.filter(i=>i._id!==e))||[],this.updateMembers(a))};this.globalSer.alertConfirm({header:"Confirme",message:"\xbfEst\xe1 seguro qu\xe9 desea quitar a este miembro del grupo?",confirmAction:()=>i()})}getParamsToMap(){return[{type:"Feature",geometry:this.group.location}]}setFormDataAndSave(e){this.formData=e,this.updateData()}}return e.\u0275fac=function(i){return new(i||e)(d.Jb(a.a),d.Jb(c.a),d.Jb(m.a),d.Jb(b.U))},e.\u0275cmp=d.Db({type:e,selectors:[["app-detalles-grupo"]],decls:9,vars:2,consts:[["slot","start"],[3,"click"],["name","arrow-back-outline"],[4,"ngIf"],[1,"ion-no-padding","ion-no-margin"],["color","primary"],[3,"name"],["class","ion-margin-bottom",4,"ngIf","ngIfElse"],["noMembers",""],["slot","end"],[3,"click",4,"ngIf"],[1,"ion-margin"],["slot","end",4,"ngIf"],["class","ion-no-margin","size","12",4,"ngIf"],["size","12","size-md","6",4,"ngIf"],["name","close-outline"],["color","light",3,"click",4,"ngIf"],["color","light","expand","full","slot","end",3,"click",4,"ngIf"],["color","light",3,"click"],["name","close-outline","slot","start"],["color","light","expand","full","slot","end",3,"click"],["name","create-outline","slot","start"],["size","12",1,"ion-no-margin"],[3,"data","handleSave","handleCancel"],["size","12","size-md","6"],["size","12",1,"ion-no-padding"],["size","5"],["size","7"],[1,"div-map"],[3,"coords","height","zoom"],[1,"ion-margin-bottom"],["size","12","size-sm","6",1,"ion-margin-top"],["title","L\xedder","role","leader",3,"data","handleAdd","handleRemove"],["title","Anfitri\xf3n","role","host",3,"data","handleAdd","handleRemove"],["title","Auxiliar","role","helper",3,"data","handleAdd","handleRemove"],["title","Maestro","role","master",3,"data","handleAdd","handleRemove"],[1,"ion-margin-top"],["size","12"],["color","medium"],[1,"ion-text-center"],["name","alert-circle-outline"],["name","add-outline"],["size","12",1,"ion-margin-top"],[4,"ngIf","ngIfElse"],["noAssistants",""],["size","12","size-sm","6",4,"ngFor","ngForOf"],["size","12","size-sm","6"],[3,"user","handleRemove","added"],["color","primary",1,"ion-margin-top",3,"click"],["name","add-outline","slot","start"]],template:function(e,i){1&e&&(d.Mb(0,"ion-header"),d.Mb(1,"ion-toolbar"),d.Mb(2,"ion-buttons",0),d.Mb(3,"ion-button",1),d.Ub("click",function(){return i.back()}),d.Kb(4,"ion-icon",2),d.Lb(),d.Lb(),d.Mb(5,"ion-title"),d.pc(6),d.Lb(),d.Lb(),d.Lb(),d.Mb(7,"ion-content"),d.nc(8,q,30,22,"div",3),d.Lb()),2&e&&(d.xb(6),d.qc(i.title),d.xb(2),d.Zb("ngIf",i.group))},directives:[b.r,b.P,b.f,b.e,b.s,b.N,b.o,n.i,b.g,b.i,b.h,b.E,b.K,b.n,u.a,h.a,v,n.h,g.a],styles:[""]}),e})()}];let C=(()=>{class e{}return e.\u0275mod=d.Hb({type:e}),e.\u0275inj=d.Gb({factory:function(i){return new(i||e)},imports:[[a.j.forChild(U)],a.j]}),e})();var _=t("j1ZV");let G=(()=>{class e{}return e.\u0275mod=d.Hb({type:e}),e.\u0275inj=d.Gb({factory:function(i){return new(i||e)},imports:[[n.b,o.a,b.Q,C,_.a]]}),e})()}}]);