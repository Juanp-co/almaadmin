(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"9smr":function(i,e,o){"use strict";o.r(e),o.d(e,"RegistrarVisitaPageModule",function(){return L});var t=o("ofXK"),n=o("3Pt+"),s=o("TEn/"),r=o("tyNb"),a=o("mrSG"),l=o("Wgwc"),b=o.n(l),c=o("uAKu"),d=o("OmbT"),m=o("fXoL"),u=o("4WDQ"),h=o("l2JI");function g(i,e){if(1&i){const i=m.Nb();m.Mb(0,"ion-col"),m.Mb(1,"ion-item"),m.Mb(2,"ion-label",7),m.pc(3,"Miembro visitante (*)"),m.Lb(),m.Mb(4,"ion-input",24),m.Ub("click",function(){return m.ic(i),m.Wb().showMembersModal("visitor")}),m.Lb(),m.Lb(),m.Lb()}if(2&i){const i=m.Wb();m.xb(4),m.Zb("readonly",!0)("value",i.getMemberVisitorNames())}}function M(i,e){if(1&i&&(m.Mb(0,"ion-item"),m.Mb(1,"ion-label"),m.pc(2),m.Lb(),m.Kb(3,"ion-radio",25),m.Lb()),2&i){const i=e.$implicit,o=e.index;m.xb(2),m.qc(i),m.xb(1),m.Zb("value",o)}}const v=[{path:"",component:(()=>{class i{constructor(i,e,o,t,n){this.globalSer=i,this.consolidadosService=e,this.navCtrl=o,this.modalCtrl=t,this.router=n,this.formData={userId:null,visitor:null,observation:null,action:0,date:null},this.iAmVisitor=!0,this.listActions=["Visita","Llamada"],this.memberSelected=null,this.memberVisitor=null,this.members=[],this.maxInitDate=b()().format("YYYY-MM-DD")}ngOnInit(){return Object(a.a)(this,void 0,void 0,function*(){this.globalSer.checkSession()?yield this.getMembers():yield this.router.navigate(["/ingresar"])})}getMembers(){return Object(a.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading();const i=yield this.consolidadosService.getConsolidatesMembers();i&&!i.error?(this.members=i,yield this.globalSer.dismissLoading()):i&&i.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}saveVisit(){var i,e;return Object(a.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading("Guardando, por favor espere...");const o=Object.assign({},this.formData);o.date=o.date.substr(0,10),o.observation=(""+Object(d.s)(o.observation,!0)).toUpperCase(),o.userId=null===(i=this.memberSelected)||void 0===i?void 0:i._id,o.visitor=(null===(e=this.memberVisitor)||void 0===e?void 0:e._id)||null;const t=yield this.consolidadosService.saveConsolidateReport(o);t&&!t.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.presentAlert("\xa1\xc9xito!",t||"Se ha registrado la visita exitosamente."),yield this.back()):t&&t.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}closeModal(){return Object(a.a)(this,void 0,void 0,function*(){yield this.modalCtrl.dismiss()})}back(){return Object(a.a)(this,void 0,void 0,function*(){yield this.navCtrl.back()})}setCheckedValue(){this.iAmVisitor||(this.formData.visitor=null,this.memberVisitor=null),this.iAmVisitor=!this.iAmVisitor}showMembersModal(i="member"){return Object(a.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading(),yield this.globalSer.dismissLoading(),yield this.globalSer.loadModal(c.a,{data:this.members,selectedUser:this.memberSelected||null},!0,e=>{e&&("member"===i?this.memberSelected=e:this.memberVisitor=e)})})}getConsolidatorsNames(){return this.memberSelected?`${this.memberSelected.names} ${this.memberSelected.lastNames}`:null}getMemberVisitorNames(){return this.memberVisitor?`${this.memberVisitor.names} ${this.memberVisitor.lastNames}`:null}validate(){const{action:i,date:e,observation:o}=this.formData;return this.memberSelected?e?null===i?"Disculpe, pero debe seleccionar la acci\xf3n realizda en la visita.":!o||(null==o?void 0:o.length)<5?"Disculpe, pero debe indicar una observaci\xf3n v\xe1lida para la visita.":this.iAmVisitor||this.memberVisitor?null:"Disculpe, pero debe seleccionar al miembro que realiz\xf3 la visita.":"Disculpe, pero debe indicar la fecha en la que se realiz\xf3 la visita.":"Disculpe, pero seleccionar al miembro que fue visitado."}confirmClose(){return Object(a.a)(this,void 0,void 0,function*(){yield this.globalSer.alertConfirm({message:"\xbfEst\xe1 seguro qu\xe9 desea cancelar el registro de la visita?",confirmAction:()=>Object(a.a)(this,void 0,void 0,function*(){yield this.back()})})})}confirmSave(){return Object(a.a)(this,void 0,void 0,function*(){const i=this.validate();i?yield this.globalSer.presentAlert("Alerta",i):yield this.globalSer.alertConfirm({message:"\xbfEst\xe1 seguro qu\xe9 desea guardar la informaci\xf3n suministrada de la visita?",confirmAction:()=>Object(a.a)(this,void 0,void 0,function*(){yield this.saveVisit()})})})}}return i.\u0275fac=function(e){return new(e||i)(m.Jb(u.a),m.Jb(h.a),m.Jb(s.U),m.Jb(s.T),m.Jb(r.g))},i.\u0275cmp=m.Db({type:i,selectors:[["app-registrar-visita"]],decls:60,vars:9,consts:[["slot","start"],[3,"click"],["name","arrow-back-outline"],["size","12",1,""],["size","12","size-sm","6"],[1,"ion-no-padding"],["size","12"],["position","floating","color","medium"],["autocomplete","off",1,"no-selected-text",3,"readonly","value","click"],["lines","none"],["color","medium"],["slot","start",3,"checked","ionChange"],[4,"ngIf"],["displayFormat","DD/MM/YYYY","min","2021-01-01","doneText","Listo","cancelText","Cancelar",3,"ngModel","max","ngModelChange"],[3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["rows","5","placeholder","Indica alguna observaci\xf3n...",1,"ion-text-uppercase",3,"ngModel","ngModelChange"],["size","12",1,"ion-margin-top"],[1,"toSmall"],["size","12",1,"ion-margin-top","ion-margin-bottom","ion-text-center"],["color","medium",3,"click"],["name","close-outline","slot","start"],["color","primary",3,"click"],["name","save-outline","slot","start"],["autocomplete","off",3,"readonly","value","click"],["slot","start",3,"value"]],template:function(i,e){1&i&&(m.Mb(0,"ion-header"),m.Mb(1,"ion-toolbar"),m.Mb(2,"ion-buttons",0),m.Mb(3,"ion-button",1),m.Ub("click",function(){return e.confirmClose()}),m.Kb(4,"ion-icon",2),m.Lb(),m.Lb(),m.Mb(5,"ion-title"),m.pc(6,"Registrar visita"),m.Lb(),m.Lb(),m.Lb(),m.Mb(7,"ion-content"),m.Mb(8,"ion-card"),m.Mb(9,"ion-card-content"),m.Mb(10,"ion-row"),m.Mb(11,"ion-col",3),m.Mb(12,"ion-row"),m.Mb(13,"ion-col",4),m.Mb(14,"ion-row",5),m.Mb(15,"ion-col",6),m.Mb(16,"ion-item"),m.Mb(17,"ion-label",7),m.pc(18,"Miembro (*)"),m.Lb(),m.Mb(19,"ion-input",8),m.Ub("click",function(){return e.showMembersModal()}),m.Lb(),m.Lb(),m.Lb(),m.Mb(20,"ion-col",6),m.Mb(21,"ion-row"),m.Mb(22,"ion-col"),m.Mb(23,"ion-item",9),m.Mb(24,"ion-label",10),m.pc(25,"Soy el visitador"),m.Lb(),m.Mb(26,"ion-checkbox",11),m.Ub("ionChange",function(){return e.setCheckedValue()}),m.Lb(),m.Lb(),m.Lb(),m.nc(27,g,5,2,"ion-col",12),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Mb(28,"ion-col",4),m.Mb(29,"ion-row",5),m.Mb(30,"ion-col",6),m.Mb(31,"ion-item"),m.Mb(32,"ion-label",7),m.pc(33,"Fecha de la visita (*)"),m.Lb(),m.Mb(34,"ion-datetime",13),m.Ub("ngModelChange",function(i){return e.formData.date=i}),m.Lb(),m.Lb(),m.Lb(),m.Mb(35,"ion-col",6),m.Mb(36,"ion-list"),m.Mb(37,"ion-radio-group",14),m.Ub("ngModelChange",function(i){return e.formData.action=i}),m.Mb(38,"ion-list-header"),m.Mb(39,"ion-label"),m.pc(40,"Acci\xf3n"),m.Lb(),m.Lb(),m.nc(41,M,4,2,"ion-item",15),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Mb(42,"ion-col",6),m.Mb(43,"ion-item"),m.Mb(44,"ion-label",7),m.pc(45,"Observaciones (*)"),m.Lb(),m.Mb(46,"ion-textarea",16),m.Ub("ngModelChange",function(i){return e.formData.observation=i}),m.Lb(),m.Lb(),m.Lb(),m.Mb(47,"ion-col",17),m.Mb(48,"ion-text",10),m.Mb(49,"i",18),m.pc(50,"(*) Campos requeridos."),m.Lb(),m.Lb(),m.Lb(),m.Mb(51,"ion-col",19),m.Mb(52,"ion-button",20),m.Ub("click",function(){return e.confirmClose()}),m.Kb(53,"ion-icon",21),m.Mb(54,"ion-text"),m.pc(55,"Cancelar"),m.Lb(),m.Lb(),m.Mb(56,"ion-button",22),m.Ub("click",function(){return e.confirmSave()}),m.Kb(57,"ion-icon",23),m.Mb(58,"ion-text"),m.pc(59,"Guardar"),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb()),2&i&&(m.xb(19),m.Zb("readonly",!0)("value",e.getConsolidatorsNames()),m.xb(7),m.Zb("checked",e.iAmVisitor),m.xb(1),m.Zb("ngIf",!e.iAmVisitor),m.xb(7),m.Zb("ngModel",e.formData.date)("max",e.maxInitDate),m.xb(3),m.Zb("ngModel",e.formData.action),m.xb(4),m.Zb("ngForOf",e.listActions),m.xb(5),m.Zb("ngModel",e.formData.observation))},directives:[s.r,s.P,s.f,s.e,s.s,s.N,s.o,s.g,s.h,s.E,s.n,s.v,s.w,s.u,s.Y,s.l,s.b,t.i,s.p,s.X,n.e,n.f,s.x,s.C,s.y,t.h,s.L,s.K,s.B,s.V],styles:[""]}),i})()}];let f=(()=>{class i{}return i.\u0275mod=m.Hb({type:i}),i.\u0275inj=m.Gb({factory:function(e){return new(e||i)},imports:[[r.j.forChild(v)],r.j]}),i})(),L=(()=>{class i{}return i.\u0275mod=m.Hb({type:i}),i.\u0275inj=m.Gb({factory:function(e){return new(e||i)},imports:[[t.b,n.a,s.Q,f]]}),i})()}}]);