(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"+woh":function(t,e,i){"use strict";i.d(e,"a",function(){return v});var n=i("mrSG"),o=i("+z1p"),r=i("Wgwc"),a=i.n(r),s=i("OmbT"),l=i("fXoL"),u=i("EnSQ"),c=i("1Ldg"),d=i("4WDQ");let f=(()=>{class t{constructor(t,e){this.axios=t,this.globalSer=e}addEvent(t){return Object(n.a)(this,void 0,void 0,function*(){const e=yield this.axios.postData("/admin/events",t);return e&&e.success?e.data:this.globalSer.altResponse(e)})}updateEvent(t,e){return Object(n.a)(this,void 0,void 0,function*(){const i=yield this.axios.putData("/admin/events/"+t,e);return i&&i.success?i.data:this.globalSer.altResponse(i)})}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(c.a),l.Qb(d.a))},t.\u0275prov=l.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var m=i("TEn/"),b=i("ofXK"),h=i("zioG");const p=function(t){return{backgroundImage:t,height:"200px"}};function g(t,e){if(1&t&&l.Kb(0,"div",25),2&t){const t=l.Wb();l.Zb("ngStyle",l.ec(1,p,"url("+t.formData.picture+")"))}}function D(t,e){1&t&&l.Kb(0,"img",26)}let v=(()=>{class t{constructor(t,e,i,n){this.dataService=t,this.eventsFormService=e,this.globalSer=i,this.navCtrl=n,this.Editor=o,this.configEditor=null,this.formData={_id:null,title:null,description:null,date:null,initHour:null,endHour:null,picture:null,toRoles:[],rolesSelected:""},this.roles=["Administradores","Pastores","Supervisores","L\xedderes","Personas"],this.minDate=a()().add(1,"d").format("YYYY-MM-DD"),this.maxDate=a()().add(5,"y").format("YYYY-MM-DD"),this.minInitHour=a()().add(1,"d").startOf("d").format("HH:[00]"),this.minEndHour=a()().startOf("d").add(1,"d").format("HH:[00]"),this.configEditor=this.globalSer.configEditor,this.configEditor.description="Indica una descripci\xf3n para el evento ..."}ngOnInit(){this.eventData&&this.setDataForm()}addEvent(t){return Object(n.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading("Agregando evento, por favor espere ...");const e=yield this.eventsFormService.addEvent(t);e&&!e.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.presentAlert("\xa1\xc9xito!",e.msg||"Se ha agregado el evento exitosamente."),yield this.navCtrl.back()):e&&e.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}updateEvent(t){return Object(n.a)(this,void 0,void 0,function*(){yield this.globalSer.presentLoading("Actualizando evento, por favor espere ...");const e=yield this.eventsFormService.updateEvent(this.eventData._id||null,t);if(e&&!e.error){const{event:t,msg:i}=e;yield this.globalSer.dismissLoading(),yield this.globalSer.presentAlert("\xa1\xc9xito!",i||"Se ha actualizado el evento exitosamente."),this.save(t)}else e&&e.error?(yield this.globalSer.dismissLoading(),yield this.globalSer.errorSession()):yield this.globalSer.dismissLoading()})}setDataForm(){if(this.eventData){const t=Object.assign({},this.eventData);this.formData._id=t?t._id:null,this.formData.title=t?t.title:null,this.formData.description=t?Object(s.r)(t.description):null,this.formData.date=t?t.date:null,this.formData.initHour=t?t.initHour:null,this.formData.endHour=t?t.endHour:null,this.formData.toRoles=t?t.toRoles:[],this.formData.picture=t?t.picture:[],this.formData.rolesSelected=this.formData.toRoles.length>0?this.getRoles(this.formData.toRoles):"",t&&(this.formData.initHour=t.initHour?a()(`${this.formData.date} ${this.formData.initHour}`).format("YYYY-MM-DDTHH:mm:ssZ"):a()(""+this.formData.date).format("YYYY-MM-DDTHH:mm:ssZ"),this.formData.endHour=t.endHour?a()(`${this.formData.date} ${this.formData.endHour}`).format("YYYY-MM-DDTHH:mm:ssZ"):a()(""+this.formData.date).format("YYYY-MM-DDTHH:mm:ssZ"))}}getHours(t){return t&&"Invalid Date"!==t?/^([0-9]{2}:[0-9]{2})/.test(t)?t:t?a()(t).format("HH:mm"):null:null}cancel(){this.handleCancel?this.handleCancel():this.navCtrl.back()}save(t){this.handleSave&&this.handleSave(t)}onChangeEditor({editor:t}){this.formData.description=t.getData()}setFormData(t,e){this.formData[t]=e.target.value||null}openFile(t){const e=t.target.files;if("object"!=typeof e[0])return!1;this.dataService.resizePhoto(e[0],900,"dataURL",t=>{this.formData.picture=t})}setMinEndHour(t,e){this.formData[t]=e.target.value,"date"===t?(this.minInitHour=a()(""+this.formData[t]).startOf("d").format("HH:[00]"),this.formData.initHour||(this.formData.initHour=a()(""+this.formData[t]).startOf("d").format("YYYY-MM-DDTHH:[00]:ssZ")),this.formData.endHour?this.minEndHour=a()(""+this.formData.initHour).add(1,"h").format("HH:[00]"):(this.minEndHour=a()(""+this.formData.initHour).startOf("d").add(1,"h").format("HH:[00]"),this.formData.endHour=a()(""+this.formData.initHour).add(1,"h").format("YYYY-MM-DDTHH:[00]:ssZ"))):"initHour"===t&&(a()(""+this.formData[t]).isAfter(a()(""+this.formData.endHour))?(this.minEndHour=a()(""+this.formData[t]).add(1,"h").format("HH:[00]"),this.formData.endHour=a()(""+this.formData.initHour).add(1,"h").format("YYYY-MM-DDTHH:[00]:ssZ")):this.minEndHour=a()(""+this.formData[t]).add(1,"h").format("HH:[00]"))}setDateFormToSend(){var t,e;return{title:(null===(t=this.formData.title)||void 0===t?void 0:t.toUpperCase())||null,description:Object(s.r)(null===(e=this.formData.description)||void 0===e?void 0:e.toUpperCase())||null,date:this.formData.date?a()(this.formData.date).format("YYYY-MM-DD"):null,initHour:this.getHours(this.formData.initHour),endHour:this.getHours(this.formData.endHour),toRoles:this.formData.toRoles||[],picture:this.formData.picture}}getRoles(t){let e="";if(t.length>0)for(const i of t)""===e?e=this.roles[i]:e+=", "+this.roles[i];return e}validateForm(t){var e;return Object(s.k)(t.title)?!t.description||(null===(e=t.description)||void 0===e?void 0:e.length)<5?"Disculpe, pero debe indicar una descripci\xf3n para el evento v\xe1lida.":Object(s.b)(t.date)?Object(s.e)(t.initHour)?Object(s.e)(t.endHour)?t.toRoles&&0!==t.toRoles.length?null:"Disculpe, pero debe seleccionar los roles a los que va dirigido el evento.":"Disculpe, pero debe indicar una hora correcta para la finalizaci\xf3n del evento.":"Disculpe, pero debe indicar la hora de inicio del evento.":"Disculpe, pero debe indicar la fecha del evento.":"Disculpe, pero debe indicar el t\xedtulo correcto para el evento."}showAlertRolesList(t){return Object(n.a)(this,void 0,void 0,function*(){const e=[];for(const[i,n]of this.roles.entries())e.push({name:"roles",type:"checkbox",label:n,value:i,checked:t.indexOf(i)>-1});yield this.globalSer.alertWithList({header:"Seleccione",inputs:e,confirmAction:t=>{this.formData.toRoles=t,this.formData.rolesSelected=this.getRoles(t)}})})}confirmAction(t=!1){return Object(n.a)(this,void 0,void 0,function*(){const e=this.setDateFormToSend(),i=this.validateForm(e);if(i)yield this.globalSer.presentAlert("\xa1Error!",i||"Disculpe, pero debe completar el formulario.");else{let i="\xbfEst\xe1 seguro qu\xe9 desea __action__ este evento?";i=i.replace("__action__",t?"actualizar":"agregar"),yield this.globalSer.alertConfirm({header:"\xa1Confirme!",message:i,confirmAction:()=>{t?this.updateEvent(e):this.addEvent(e)}})}})}}return t.\u0275fac=function(e){return new(e||t)(l.Jb(u.a),l.Jb(f),l.Jb(d.a),l.Jb(m.T))},t.\u0275cmp=l.Db({type:t,selectors:[["app-events-form"]],inputs:{eventData:"eventData",goBack:"goBack",handleCancel:"handleCancel",handleSave:"handleSave"},decls:59,vars:16,consts:[["size-sm","4",1,"ion-text-center",3,"size"],[1,"ion-justify-content-center","ion-margin"],["size","12",1,"ion-text-center"],[1,"micursor","ion-text-center","w-100"],["type","file","accept","image/x-png,image/gif,image/jpeg","hidden","",3,"change"],["class","banner-event",3,"ngStyle",4,"ngIf"],["src","assets/photo.png","height","150",4,"ngIf"],[1,"toSmall"],["size","12","size-sm","8"],["size","12"],["position","floating","color","medium"],["autocomplete","off","maxlength","100",1,"ion-text-uppercase",3,"value","change"],["size","12","size-sm","4"],["displayFormat","DD/MM/YYYY","doneText","Listo","cancelText","Cancelar",3,"value","min","max","ionChange"],["displayFormat","HH:mm","minuteValues","00,15,30,45,59","doneText","Listo","cancelText","Cancelar",3,"value","min","ionChange"],["displayFormat","HH:mm","minuteValues","00,15,30,45","doneText","Listo","cancelText","Cancelar",3,"value","min","ionChange"],["autocomplete","off",1,"ion-text-uppercase","no-selected-text",3,"value","readonly","click"],["color","medium"],[3,"data","editor","config","change"],["size","12",1,"ion-margin-top"],[1,"ion-margin-top"],["color","medium",1,"ion-text-center",3,"click"],["name","close-outline","slot","start"],["color","primary",1,"ion-text-center",3,"click"],["name","checkmark-outline","slot","start"],[1,"banner-event",3,"ngStyle"],["src","assets/photo.png","height","150"]],template:function(t,e){1&t&&(l.Mb(0,"ion-card-content"),l.Mb(1,"ion-row"),l.Mb(2,"ion-col",0),l.Mb(3,"ion-row",1),l.Mb(4,"ion-col",2),l.Mb(5,"label",3),l.Mb(6,"input",4),l.Ub("change",function(t){return e.openFile(t)}),l.Lb(),l.nc(7,g,1,3,"div",5),l.nc(8,D,1,0,"img",6),l.Lb(),l.Lb(),l.Mb(9,"ion-col",2),l.Mb(10,"ion-text"),l.Mb(11,"i",7),l.pc(12,"Clic para cargar una imagen para el evento (opcional)"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Mb(13,"ion-col",8),l.Mb(14,"ion-row"),l.Mb(15,"ion-col",9),l.Mb(16,"ion-item"),l.Mb(17,"ion-label",10),l.pc(18,"T\xedtulo del evento (*)"),l.Lb(),l.Mb(19,"ion-input",11),l.Ub("change",function(t){return e.setFormData("title",t)}),l.Lb(),l.Lb(),l.Lb(),l.Mb(20,"ion-col",12),l.Mb(21,"ion-item"),l.Mb(22,"ion-label",10),l.pc(23,"Fecha del evento (*)"),l.Lb(),l.Mb(24,"ion-datetime",13),l.Ub("ionChange",function(t){return e.setMinEndHour("date",t)}),l.Lb(),l.Lb(),l.Lb(),l.Mb(25,"ion-col",12),l.Mb(26,"ion-item"),l.Mb(27,"ion-label",10),l.pc(28,"Hora inicio (*)"),l.Lb(),l.Mb(29,"ion-datetime",14),l.Ub("ionChange",function(t){return e.setMinEndHour("initHour",t)}),l.Lb(),l.Lb(),l.Lb(),l.Mb(30,"ion-col",12),l.Mb(31,"ion-item"),l.Mb(32,"ion-label",10),l.pc(33,"Hora fin (*)"),l.Lb(),l.Mb(34,"ion-datetime",15),l.Ub("ionChange",function(t){return e.setMinEndHour("endHour",t)}),l.Lb(),l.Lb(),l.Lb(),l.Mb(35,"ion-col",9),l.Mb(36,"ion-item"),l.Mb(37,"ion-label",10),l.pc(38,"Dirigido a (*)"),l.Lb(),l.Mb(39,"ion-input",16),l.Ub("click",function(){return!e.showAlertRolesList(e.formData.toRoles)}),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Mb(40,"ion-col",9),l.Mb(41,"ion-item"),l.Mb(42,"ion-label",17),l.pc(43,"Descripci\xf3n del evento (*)"),l.Lb(),l.Lb(),l.Mb(44,"ckeditor",18),l.Ub("change",function(t){return e.onChangeEditor(t)}),l.Lb(),l.Lb(),l.Mb(45,"ion-col",19),l.Mb(46,"ion-text",17),l.Mb(47,"i",7),l.pc(48,"(*) Campos requeridos."),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Mb(49,"ion-row",20),l.Mb(50,"ion-col",2),l.Mb(51,"ion-button",21),l.Ub("click",function(){return e.cancel()}),l.Kb(52,"ion-icon",22),l.Mb(53,"ion-text"),l.pc(54,"Cancelar"),l.Lb(),l.Lb(),l.Mb(55,"ion-button",23),l.Ub("click",function(){return e.confirmAction(null!==e.formData._id)}),l.Kb(56,"ion-icon",24),l.Mb(57,"ion-text"),l.pc(58,"Guardar"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb()),2&t&&(l.xb(2),l.Zb("size",12),l.xb(5),l.Zb("ngIf",e.formData.picture),l.xb(1),l.Zb("ngIf",!e.formData.picture),l.xb(11),l.Zb("value",e.formData.title),l.xb(5),l.Zb("value",e.formData.date)("min",e.minDate)("max",e.maxDate),l.xb(5),l.Zb("value",e.formData.initHour)("min",e.minInitHour),l.xb(5),l.Zb("value",e.formData.endHour)("min",e.minEndHour),l.xb(5),l.Zb("value",e.formData.rolesSelected)("readonly",!0),l.xb(5),l.Zb("data",e.formData.description)("editor",e.Editor)("config",e.configEditor))},directives:[m.h,m.E,m.n,b.i,m.J,m.v,m.w,m.u,m.X,m.p,m.W,h.a,m.e,m.s,b.j],styles:[".ck-editor__editable_inline{min-height:250px;color:#333!important}"]}),t})()},EnSQ:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i("fXoL");let o=(()=>{class t{constructor(){}resizePhoto(t,e,i,n){const o=new FileReader;o.onload=t=>{this.resizeReresize(t.target.result,e,i,n)},o.readAsDataURL(t)}resizeReresize(t,e,i,n){const o=new Image;o.onload=t=>{const r=document.createElement("canvas");let a=o.width,s=o.height;a>s?a>e&&(s*=e/a,a=e):s>e&&(a*=e/s,s=e),r.width=a,r.height=s,r.getContext("2d").drawImage(o,0,0,a,s),this.resizeOuput(r,i,n)},o.src=t}resizeOuput(t,e,i){switch(e){case"file":t.toBlob(t=>{i(t)},"image/jpeg",.8);break;case"dataURL":i(t.toDataURL("image/jpeg",.8))}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},OmbT:function(t,e,i){"use strict";function n(t){return t&&/^([A-Z\u00C0-\u024F\u1E00-\u1EFF]?)+([[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+[,.]?[ ]?|[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+['-]]?)+$/.test(t)}function o(t){const e=String.fromCharCode(t.charCode);/[0-9.,]/.test(e)||t.preventDefault()}function r(t){const e=String.fromCharCode(t.charCode);/[0-9]/.test(e)||t.preventDefault()}function a(t){const{value:e}=t.target;/^([A-Z\u00C0-\u024F\u1E00-\u1EFF]?)+([[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+[,.]?[ ]?|[A-Za-z\u00C0-\u024F\u1E00-\u1EFF]+['-]]?)+$/.test(e)||(t.target.value=e.substring(0,e.length-1))}function s(t){return t&&/^[0-9]{1,3}/.test(""+t)}function l(t){return t&&/^[\+]?[(]?([0-9]{2})?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(t)}function u(t){return t&&/^(?=.*\d)?(?=.*[A-Z]{1})?(?=.*[a-z]{1}?)?(?=.*[^\w\d\s:]?)([^\s]){6,25}$/.test(t)}function c(t){return t&&/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t)}function d(t){return t&&/^[a-zA-Z\xc1\xc9\xcd\xd3\xda\xc0\xc8\xcc\xd2\xd9\xe0\xe8\xec\xf2\xf9\xe1\xe9\xed\xf3\xfa\xc2\xca\xce\xd4\xdb\xe2\xea\xee\xf4\xfb\xc4\xcb\xcf\xd6\xdc\xe4\xeb\xef\xf6\xfc\xf1\xd10-9\s.,#*?\xbf\xa1!()\-+"'/@]{5,2000}/g.test(t)}function f(t){return t&&/\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])*/.test(""+t)}function m(t){return t&&/^([0-1]?[0-9]|2[0-4]):([0-5][0-9])(:[0-5][0-9])?$/.test(t)}function b(t,e=!1){return!!t&&(e?t.substr(0,40).indexOf("data:application/pdf")>-1:t.substr(0,21).indexOf("data:image/")>-1)}function h(t){return/^(?:(?:(?:http?|https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(""+t)}function p(t){return/(?:https?:\/\/)?(?:www|m\.)?(facebook|fb)\.(com|me)\/(?:(?:\w\.)*#!\/)?(?:pages\/)?(?:[\w\-\.]*\/)*([\w\-\.]*)/gi.test(""+t)}function g(t){return/(?:(?:http|https):\/\/)?(?:www\.)?(?:instagram\.com|instagr\.am)\/([A-Za-z0-9-_\.\/]+)/i.test(""+t)}function D(t){return/^(?:https?:\/\/)?(?:www\.)?twitter\.com\/(#!\/)?[a-zA-Z0-9_]+$/i.test(""+t)}function v(t){return/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/i.test(""+t)}function H(t,e=!1){return t?e?t.replace(/\n/g,"<br/>"):t.replace(/<br ?\/?>|<BR ?\/?>/g,"\n"):null}function M(t){return t?t.replace(/&NBSP;/g," "):null}i.d(e,"h",function(){return n}),i.d(e,"p",function(){return o}),i.d(e,"q",function(){return r}),i.d(e,"o",function(){return a}),i.d(e,"f",function(){return s}),i.d(e,"j",function(){return l}),i.d(e,"i",function(){return u}),i.d(e,"c",function(){return c}),i.d(e,"k",function(){return d}),i.d(e,"b",function(){return f}),i.d(e,"e",function(){return m}),i.d(e,"a",function(){return b}),i.d(e,"m",function(){return h}),i.d(e,"d",function(){return p}),i.d(e,"g",function(){return g}),i.d(e,"l",function(){return D}),i.d(e,"n",function(){return v}),i.d(e,"s",function(){return H}),i.d(e,"r",function(){return M})}}]);